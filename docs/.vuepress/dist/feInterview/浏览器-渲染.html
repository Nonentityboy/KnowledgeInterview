<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>01: 输入URL到页面呈现发生了什么？——网络篇 | 前端知识总结</title>
    <meta name="description" content="Curtin的前端笔记">
    
    
    <link rel="preload" href="/assets/css/0.styles.21921e3e.css" as="style"><link rel="preload" href="/assets/js/app.2e39a256.js" as="script"><link rel="preload" href="/assets/js/2.40514cff.js" as="script"><link rel="preload" href="/assets/js/26.bb6e9c9c.js" as="script"><link rel="prefetch" href="/assets/js/10.003b2367.js"><link rel="prefetch" href="/assets/js/11.f2aa65b9.js"><link rel="prefetch" href="/assets/js/12.5566ea95.js"><link rel="prefetch" href="/assets/js/13.e71c89ee.js"><link rel="prefetch" href="/assets/js/14.173d8e42.js"><link rel="prefetch" href="/assets/js/15.30ea5601.js"><link rel="prefetch" href="/assets/js/16.4b4b20e0.js"><link rel="prefetch" href="/assets/js/17.18a01c35.js"><link rel="prefetch" href="/assets/js/18.229c5ba1.js"><link rel="prefetch" href="/assets/js/19.8ac59ed1.js"><link rel="prefetch" href="/assets/js/20.53aef6fa.js"><link rel="prefetch" href="/assets/js/21.604cc70c.js"><link rel="prefetch" href="/assets/js/22.507dbb20.js"><link rel="prefetch" href="/assets/js/23.6484d4f7.js"><link rel="prefetch" href="/assets/js/24.1b70e5c2.js"><link rel="prefetch" href="/assets/js/25.d9c065f7.js"><link rel="prefetch" href="/assets/js/27.aa2a6a25.js"><link rel="prefetch" href="/assets/js/28.dc053cb7.js"><link rel="prefetch" href="/assets/js/29.eedd5aec.js"><link rel="prefetch" href="/assets/js/3.31e7ba5d.js"><link rel="prefetch" href="/assets/js/30.bf642b94.js"><link rel="prefetch" href="/assets/js/31.b181a037.js"><link rel="prefetch" href="/assets/js/4.bc141a6a.js"><link rel="prefetch" href="/assets/js/5.012a9a4a.js"><link rel="prefetch" href="/assets/js/6.97d7733f.js"><link rel="prefetch" href="/assets/js/7.b3035bf2.js"><link rel="prefetch" href="/assets/js/8.700166fe.js"><link rel="prefetch" href="/assets/js/9.f63f5711.js">
    <link rel="stylesheet" href="/assets/css/0.styles.21921e3e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">前端知识总结</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">主页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">知识图谱</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/feInterview/" class="nav-link router-link-active">前端基础进阶</a></li><li class="dropdown-item"><!----> <a href="/feFramework/" class="nav-link">前端框架进阶</a></li><li class="dropdown-item"><!----> <a href="/csInterview/" class="nav-link">计算机基础进阶</a></li><li class="dropdown-item"><!----> <a href="/JSalgorithm/" class="nav-link">算法与数据结构</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="https://www.github.com/nonentityboy" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">主页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">知识图谱</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/feInterview/" class="nav-link router-link-active">前端基础进阶</a></li><li class="dropdown-item"><!----> <a href="/feFramework/" class="nav-link">前端框架进阶</a></li><li class="dropdown-item"><!----> <a href="/csInterview/" class="nav-link">计算机基础进阶</a></li><li class="dropdown-item"><!----> <a href="/JSalgorithm/" class="nav-link">算法与数据结构</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="https://www.github.com/nonentityboy" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/feInterview/HTML.html" class="sidebar-link">HTML相关</a></li><li><a href="/feInterview/CSS.html" class="sidebar-link">CSS</a></li><li><a href="/feInterview/JS_base.html" class="sidebar-link">JS基础</a></li><li><a href="/feInterview/JS_array.html" class="sidebar-link">JS深入数组</a></li><li><a href="/feInterview/JS_V8.html" class="sidebar-link">JS深入V8引擎</a></li><li><a href="/feInterview/JS_promise.html" class="sidebar-link">JS-异步I/O及异步编程</a></li><li><a href="/feInterview/性能.html" class="sidebar-link">性能相关</a></li><li><a href="/feInterview/浏览器-安全.html" class="sidebar-link">浏览器-安全相关</a></li><li><a href="/feInterview/浏览器-渲染.html" class="active sidebar-link">浏览器-渲染相关</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/feInterview/浏览器-渲染.html#_01-输入url到页面呈现发生了什么？——网络篇" class="sidebar-link">01: 输入URL到页面呈现发生了什么？——网络篇</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/feInterview/浏览器-渲染.html#网络请求" class="sidebar-link">网络请求</a></li><li class="sidebar-sub-header"><a href="/feInterview/浏览器-渲染.html#网络响应" class="sidebar-link">网络响应</a></li><li class="sidebar-sub-header"><a href="/feInterview/浏览器-渲染.html#总结" class="sidebar-link">总结</a></li></ul></li></ul></li><li><a href="/feInterview/前端工程化.html" class="sidebar-link">前端工程化</a></li><li><a href="/feInterview/跨端开发.html" class="sidebar-link">跨端开发实践</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="_01-输入url到页面呈现发生了什么？——网络篇"><a href="#_01-输入url到页面呈现发生了什么？——网络篇" aria-hidden="true" class="header-anchor">#</a> 01: 输入URL到页面呈现发生了什么？——网络篇</h2> <p>我们在浏览器输入：</p> <div class="language- extra-class"><pre class="language-text"><code>https://www.baidu.com
</code></pre></div><h3 id="网络请求"><a href="#网络请求" aria-hidden="true" class="header-anchor">#</a> 网络请求</h3> <h4 id="_1-构建请求"><a href="#_1-构建请求" aria-hidden="true" class="header-anchor">#</a> 1. 构建请求</h4> <p>浏览器会构建请求行:</p> <div class="language- extra-class"><pre class="language-text"><code>// 请求方法是GET，路径为根路径，HTTP协议版本为1.1
GET / HTTP/1.1
</code></pre></div><h4 id="_2-查找强缓存"><a href="#_2-查找强缓存" aria-hidden="true" class="header-anchor">#</a> 2. 查找强缓存</h4> <p>先检查强缓存，如果命中直接使用，否则进入下一步。</p> <h4 id="_3-dns解析"><a href="#_3-dns解析" aria-hidden="true" class="header-anchor">#</a> 3. DNS解析</h4> <p>由于我们输入的是域名，而数据包是通过IP地址传给对方的。因此我们需要得到域名对应的IP地址。这个过程需要依赖一个服务系统，这个系统将域名和 IP 一一映射，我们将这个系统就叫做DNS（域名系统）。得到具体 IP 的过程就是DNS解析。</p> <p>当然，值得注意的是，浏览器提供了DNS数据缓存功能。即如果一个域名已经解析过，那会把解析的结果缓存下来，下次处理直接走缓存，不需要经过 DNS解析。</p> <p>另外，如果不指定端口的话，默认采用对应的 IP 的 80 端口。</p> <h4 id="_4-建立-tcp-连接"><a href="#_4-建立-tcp-连接" aria-hidden="true" class="header-anchor">#</a> 4. 建立 TCP 连接</h4> <blockquote><p>Chrome 在同一个域名下要求同时最多只能有 6 个 TCP 连接，超过 6 个的话剩下的请求就得等待。</p></blockquote> <p>假设现在不需要等待，我们进入了 TCP 连接的建立阶段。首先解释一下什么是 TCP:</p> <p><code>TCP（Transmission Control Protocol，传输控制协议）</code>是一种面向连接的、可靠的、基于字节流的传输层通信协议。</p> <p>建立 TCP连接经历了下面三个阶段:</p> <ul><li>通过三次握手(即总共发送3个数据包确认已经建立连接)建立客户端和服务器之间的连接。</li> <li>进行数据传输。这里有一个重要的机制，就是接收方接收到数据包后必须要向发送方确认, 如果发送方没有接到这个确认的消息，就判定为数据包丢失，并重新发送该数据包。当然，发送的过程中还有一个优化策略，就是把大的数据包拆成一个个小包，依次传输到接收方，接收方按照这个小包的顺序把它们组装成完整数据包。</li> <li>断开连接的阶段。数据传输完成，现在要断开连接了，通过四次挥手来断开连接。</li></ul> <blockquote><p>你应该明白 TCP 连接通过什么手段来保证数据传输的可靠性，一是三次握手确认连接，二是数据包校验保证数据到达接收方，三是通过四次挥手断开连接。</p></blockquote> <h4 id="_5-发送-http-请求"><a href="#_5-发送-http-请求" aria-hidden="true" class="header-anchor">#</a> 5.发送 HTTP 请求</h4> <p><code>TCP连接建立完毕</code>，浏览器可以和服务器开始通信，即开始发送 HTTP 请求。浏览器发 HTTP 请求要携带三样东西:请求行、请求头和请求体。</p> <p>首先，浏览器会向服务器发送请求行,关于请求行， 我们在这一部分的第一步就构建完了，贴一下内容:</p> <div class="language- extra-class"><pre class="language-text"><code>// 请求方法是GET，路径为根路径，HTTP协议版本为1.1
GET / HTTP/1.1
</code></pre></div><p>结构很简单，由请求方法、请求URI和HTTP版本协议组成。</p> <p>同时也要带上请求头，比如我们之前说的Cache-Control、If-Modified-Since、If-None-Match都由可能被放入请求头中作为缓存的标识信息。当然了还有一些其他的属性，列举如下:</p> <div class="language- extra-class"><pre class="language-text"><code>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3
Accept-Encoding: gzip, deflate, br
Accept-Language: zh-CN,zh;q=0.9
Cache-Control: no-cache
Connection: keep-alive
Cookie: /* 省略cookie信息 */
Host: www.baidu.com
Pragma: no-cache
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit/604.1.38 (KHTML, like Gecko) Version/11.0 Mobile/15A372 Safari/604.1
</code></pre></div><p>最后是请求体，请求体只有在POST方法下存在，常见的场景是表单提交。</p> <h3 id="网络响应"><a href="#网络响应" aria-hidden="true" class="header-anchor">#</a> 网络响应</h3> <p>HTTP 请求到达服务器，服务器进行对应的处理。最后要把数据传给浏览器，也就是返回网络响应。</p> <p>跟请求部分类似，网络响应具有三个部分:响应行、响应头和响应体。</p> <p>响应行类似下面这样:</p> <div class="language- extra-class"><pre class="language-text"><code>HTTP/1.1 200 OK
</code></pre></div><p>由HTTP协议版本、状态码和状态描述组成。</p> <p>响应头包含了服务器及其返回数据的一些信息, 服务器生成数据的时间、返回的数据类型以及对即将写入的Cookie信息。</p> <p>举例如下:</p> <div class="language- extra-class"><pre class="language-text"><code>Cache-Control: no-cache
Connection: keep-alive
Content-Encoding: gzip
Content-Type: text/html;charset=utf-8
Date: Wed, 04 Dec 2019 12:29:13 GMT
Server: apache
Set-Cookie: rsv_i=f9a0SIItKqzv7kqgAAgphbGyRts3RwTg%2FLyU3Y5Eh5LwyfOOrAsvdezbay0QqkDqFZ0DfQXby4wXKT8Au8O7ZT9UuMsBq2k; path=/; domain=.baidu.com
</code></pre></div><blockquote><p>响应完成之后怎么办？TCP 连接就断开了吗？不一定。这时候要判断Connection字段, 如果请求头或响应头中包含Connection: Keep-Alive，表示建立了持久连接，这样TCP连接会一直保持，之后请求统一站点的资源会复用这个连接。</p></blockquote> <p>否则断开TCP连接, 请求-响应流程结束。</p> <h3 id="总结"><a href="#总结" aria-hidden="true" class="header-anchor">#</a> 总结</h3> <p>到此，我们来总结一下主要内容，也就是浏览器端的网络请求过程</p> <p><img src="https://s1.ax1x.com/2020/05/24/tpADW4.jpg" alt=""></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">5/25/2020, 11:26:12 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/feInterview/浏览器-安全.html" class="prev">浏览器-安全相关</a></span> <span class="next"><a href="/feInterview/前端工程化.html">前端工程化</a>→
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.2e39a256.js" defer></script><script src="/assets/js/2.40514cff.js" defer></script><script src="/assets/js/26.bb6e9c9c.js" defer></script>
  </body>
</html>
